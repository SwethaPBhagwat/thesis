


\acrodef{aLIGO}[aLIGO]
{The Advanced Laser Interferometer Gravitational Wave Observatory}
\acrodef{AdV}[AdV]{Advanced Virgo}
\acrodef{CBC}[CBC]{compact binary coalescence}
\acrodef{S6}[S6]{LIGO's sixth science run}
\acrodef{VSR23}[VSR2 and VSR3]{Virgo's second and third science runs}
\acrodef{EM}[EM]{electromagnetic}
\acrodef{GW}[GW]{gravitational wave}
\acrodef{NS}[NS]{neutron star}
\acrodef{BH}[BH]{black hole}
\acrodef{BNS}[BNS]{binary neutron star}
\acrodef{NSBH}[NSBH]{neutron-star--black-hole}
\acrodef{GRB}[GRB]{gamma-ray burst}
\acrodef{S5}[S5]{LIGO's fifth science run}
\acrodef{S4}[S4]{LIGO's fourth science run}
\acrodef{VSR1}[VSR1]{Virgo's first science run}

\acrodef{PSD}[PSD]{power spectral density}
\acrodef{VSR3}[VSR3]{Virgo's third science run}
\acrodef{BBH}[BBH]{binary black holes}
\acrodef{SNR}[SNR]{signal-to-noise ratio}
\acrodef{SPA}[SPA]{stationary-phase approximation}
\acrodef{LHO}[LHO]{LIGO Hanford Observatory}
\acrodef{LLO}[LLO]{LIGO Livingston Observatory}
\acrodef{LSC}[LSC]{LIGO Scientific Collaboration}
\acrodef{PN}[PN]{Post-Newtonian}
\acrodef{DQ}[DQ]{data quality}
\acrodef{IFO}[IFO]{interferometer}
\acrodef{DTF}[DTF]{detection template families}
\acrodef{FAR}[FAR]{false alarm rate}
\acrodef{FAP}[FAP]{false alarm probability}
\acrodef{PTF}[PTF]{physical template family}
\acrodef{ADE}[ADE]{advanced detector era}
\acrodef{FFT}[FFT]{Fast Fourier Transformation}
\acrodef{GPU}[GPU]{graphical processing unit}
\acrodef{ISCO}[ISCO]{inner-most stable circular orbit}
\acrodef{MECO}[MECO]{minimum energy condition}

\section{Introduction}
\label{sec:intro}

\ac{aLIGO} will
begin observing the gravitational-wave sky in 2015~\cite{Aasi:2013wya}. When
\ac{aLIGO} reaches design sensitivity, it will be sensitive to a volume of the
universe a thousand times greater than the first-generation LIGO
detectors~\cite{Harry:2010zz}. The French-Italian \ac{AdV} detector
will begin observations shortly after \ac{aLIGO}, forming a world-wide network
of gravitational-wave
observatories~\cite{Aasi:2013wya,aVirgo,AdV2}.
One of the most interesting sources for \ac{aLIGO} and \ac{AdV} is the inspiral
and merger of \ac{NSBH} binaries. It has been argued that
Cyg X-3 is a possible \ac{NSBH} \emph{progenitor}~\cite{Belczynski:2012jc},
however \ac{NSBH} binaries have not been observed by radio or other
electromagnetic observations. The first direct detection of a \ac{NSBH} binary
will likely be made with \ac{aLIGO} and \ac{AdV}. Population-synthesis models 
of binary evolution predict
that \ac{aLIGO} should see 0.2--300 \ac{NSBH} binaries per
year~\cite{Abadie:2010cf}. Direct detection of the gravitational waves from NSBH
binaries would confirm their existence and allow us to explore the astrophysics
behind the formation and evolution of these systems.

The gravitational waves radiated by \ac{NSBH} binaries are expected to be
significantly affected by the black hole's angular momentum
(spin), which is expected to be comparable to the orbital angular momentum of
the binary~\cite{Cutler:1992tc,Apostolatos:1994mx,Kidder:1992fr,Kidder:1995zr}.
Spin-orbit coupling changes the gravitational waveform of the binary's inspiral
and merger and can cause the orbital plane of the binary to
precess~\cite{Apostolatos:1994mx}. Coupling between the black hole spin and the
neutron star spin~\cite{Kidder:1995zr}, the quadrupole-monopole interaction due
to the spheroidal deformation of spinning black holes and neutron
stars~\cite{Poisson:1997ha} and the ``self-spin''
interaction~\cite{Mikoczi:2005dn} will also effect the gravitational waveform
emitted during a \ac{NSBH} binary inspiral.
The resulting changes in the waveform observed by \ac{aLIGO}
carry a great deal of information about the dynamics of the binary. However,
optimal searches of \ac{aLIGO} data must incorporate this dynamics into their
waveform models to avoid a reduction in sensitivity and hence the rate of
detected events. Variation between the available waveform models, and with 
nature's waveforms, will also cause a reduction in sensitivity, we investigate 
this issue in a companion work~\cite{Nitz:2013mxa}.

Gravitational wave searches for the merger of two compact objects rely on
matched-filtering against compact binary merger gravitational waveform
models~\cite{Wainstein,Helstrom,Allen:2005fk}.
Compact binary mergers in quasi-circular orbit are described by 15
parameters; the masses, spin magnitude, spin orientations, source orientation,
sky location, distance and time and phase of
coalescence~\cite{Peters:1963ux,Th300}. Matched-filter
searches must be capable of detecting binary mergers regardless of the
parameters of the system. For non-precessing systems and restricting to the
dominant gravitational wave mode, the extrinsic parameters - source orientation,
sky location, distance and coalescence phase - only effect the overall phase and
amplitude of the observed gravitational wave system. Therefore, it is possible
to analytically maximize over these extrinsic parameters \cite{Allen:2005fk}.

Changing the masses and spin magnitudes of a non-precessing system will change
the intrinsic phase evolution of the system. To be able to detect \ac{NSBH}
systems within the desired parameter range a set of waveforms or ``template
bank'' must be
constructed~\cite{Sathyaprakash:1991mt,Poisson:1995ef,Owen:1995tm,Owen:1998dk,
Babak:2006ty,Balasubramanian:1995bm,Cokelaer:2007kx}. These waveforms should
span the desired range of mass and spins.
The standard practice is to construct a bank of waveforms such that any
waveform within the parameter space of interest would be recovered with at
least 97\% of the optimal \ac{SNR} by at least one waveform in the template
bank~\cite{Babak:2006ty,Babak:2012zx} . However, the geometrical
placement algorithms employed in the most recent searches for \acp{CBC} in 
LIGO and Virgo data are only appplicable for compact binary systems whose 
components have no angular momentum---non-spinning 
systems~\cite{Abbott:2009tt,Abbott:2009qj,Abadie:2010yba,Abadie:2011nz}. 
Stochastic
placement algorithms~\cite{Babak:2008rb,Harry:2009ea,Manca:2009xw,Ajith:2012mn}
are capable of placing banks of waveforms where the spin of the
black hole is aligned with the orbital angular momentum (aligned-spin
\ac{NSBH})~\cite{Ajith:2012mn}. However,
these algorithms are known to need more templates to cover a parameter space
when compared to geometric algorithms~\cite{Harry:2009ea}. In 
\cite{Brown:2012qf} we developed a new geometrical placement algorithm that 
could place template banks of aligned-spin \ac{BNS} signals. In this work we 
expand that method to be able to place template banks of aligned-spin \ac{NSBH} 
signals.

When precessing systems are considered as template waveforms, the matched-filter
search becomes more complex. In this case the extrinsic parameters no longer
enter as overall phase and amplitude shifts in the
waveform~\cite{Apostolatos:1994mx}. Previous work has been conducted to explore
the affect of precession on gravitational-wave searches and to develop methods
to detect precessing
systems~\cite{Apostolatos:1996rf,Buonanno:2002fy,Grandclement:2002dv,
Grandclement:2002vx,Grandclement:2003ck,Pan:2003qt,Buonanno:2004yd,
Buonanno:2005pt, Abbott:2007ai,VanDenBroeck:2009gd,Fazi:2009,Harry:2011qh,
Ajith:2012mn, Brown:2012gs,Lundgren:2013jla}. However, these searches, when
applied to Initial LIGO and Virgo data, have not shown an increase in efficiency
with respect to non-precessing searches~\cite{VanDenBroeck:2009gd}. This is
because the filtering codes allow for increased, and unphysical, freedom when
maximizing over extrinsic parameters and because no suitable method to
distinguish gravitational wave signals from non-Gaussian instrumental noise has
been developed for these searches. Therefore, searches for \ac{NSBH} binaries
in data from LIGO and Virgo's most recent science runs ignored spin affects and
used quasi-circular templates to search for \ac{NSBH}
binaries~\cite{Abbott:2009tt,Abbott:2009qj,Abadie:2010yba,Abadie:2011nz}.

The majority of previous work considered the Initial LIGO detectors. \ac{aLIGO}
will have a substantially different noise curve than Initial
LIGO~\cite{Aasi:2013wya}. Conclusions drawn using the Initial LIGO sensitivity
curve may not hold when considering \ac{aLIGO}. A previous study considering
\ac{aLIGO} sensitivity curves has suggested that it may be possible to detect
generic, precessing \ac{NSBH} binaries using aligned-spin 
waveforms~\cite{Ajith:2012mn}. However, other studies have suggested that
precession may significantly change the gravitational waveform seen by
\ac{aLIGO}, requiring templates that explicitly capture this
effect~\cite{Brown:2012gs}.

In this paper, we first investigate the effect of ignoring spin on optimal
(matched-filter) searches for \ac{NSBH} binaries with \ac{aLIGO}. We demonstrate
that the quasi-circular templates used in Initial LIGO will reduce the detection
rate by $33 - 37\%$ for \ac{NSBH} systems with masses uniformly distributed 
between
$(10\pm0.5,1.4\pm0.05)M_{\odot}$, an isotropic black hole spin distribution and 
spin magnitude uniformly distributed between 0 and 1. Over a wider range of 
uniformly distributed masses, $(3-15,1-3)M_{\odot}$, we find that the detection 
rate would be reduced
by $31 - 36\%$. In both cases this loss in detection rate is 
compared against a template bank where every signal is matched
exactly by the bank of filters. The loss in event rate is greatest for
\ac{NSBH} binaries with large black-hole spins and large mass ratios. The range
quoted in both measurements is due to uncertainty in the waveform models used to
simulate \ac{NSBH} gravitational-wave signals. These values also strongly 
depend on the signal distributions that we selected. If nature does not provide 
a uniform distribution of masses and an isotropic distribution of masses then 
these averaged values will change. To account for this, we explore the ability 
to recover \ac{NSBH} signals as a function of their spins and masses in section 
\ref{sec:resultsII_generic}.

We expand upon the method we
introduced in \cite{Brown:2012qf} and
construct a bank of templates for aligned-spin \ac{NSBH} binaries. We
demonstrate that this template bank is effectual for recovering the population
of aligned-spin \ac{NSBH} systems that it is designed to detect. We
assess the ability of an aligned-spin template bank to detect a population of
generic
\ac{NSBH} binaries where the black hole spin is not constrained to be parallel
to the orbital angular momentum. We find using the aligned-spin
bank will reduce the detection rate by $17-23\%$ compared to using a bank where
every signal matches exactly with one of the filter waveforms when searching 
for \ac{NSBH} waveforms with masses $(3-15,1-3)M_{\odot}$. When restricting the 
mass range to $(10\pm0.5,1.4\pm0.05)M_{\odot}$ we find that the detection rate 
is reduced by $26-33\%$. We find that
there are regions of the \ac{NSBH} signal parameter space where precession
effects cause a significant reduction in signal-to-noise ratio. These regions 
are those where the black hole's angular momentum is large in comparison to 
the orbital angular momentum. We suggest possible methods for constructing 
searches that recover these systems. By considering several \ac{NSBH} waveform 
models, we demonstrate that our results are robust against possible errors in 
the post-Newtonian phasing for \ac{NSBH} binaries.

There has been a great deal of recent work focused on numerically 
modelling the merger of a black hole and a neutron 
star~\cite{Duez:2009yz,Shibata:2011jka,Pannarale:2012ux,Lackey:2013axa,
Foucart:2013psa}. However, there is not currently any widely available waveform 
model 
that includes both the full evolution of a \ac{NSBH} coalescence \emph{and} 
includes precessional effects over the full parameter space that we consider.
Therefore, in this work we have restricted ourselves to considering 
post-Newtonian, inspiral-only signal waveforms and consider only the case of two 
point particles. If a full 
inspiral-merger-ringdown, precessing \ac{NSBH} waveform model 
becomes available, it would be informative to compare results with that model 
against those presented here. However, in this work the black hole mass is 
restricted to be less than $15M_{\odot}$. It has been demonstrated that 
inspiral-only template banks recover $> 95\%$ of the signal power of 
numerically modelled $(3+15)M_{\odot}$ binary black hole 
waveforms~\cite{Brown:2012nn,Smith:2013mfa}. It has also been demonstrated that 
non-spinning \ac{NSBH} mergers with total mass $\sim 10M_{\odot}$ are 
indistinguishable from \ac{BBH} mergers with the same 
masses~\cite{Foucart:2013psa}. With these observations we expect that 
our results are qualitatively valid in the parameter space we study.

The layout of this work is as follows. In section \ref{sec:nsbhpop} we describe
the set of \ac{NSBH} systems that we use to assess
the performance of our template banks. In section \ref{sec:waveform_model} we
discuss the waveform models that we use in our simulations. In section
\ref{sec:bank_testing} we discuss the methods we use to test the template
banks. In section \ref{sec:bank_method} we describe our new method to
create banks of aligned-spin filter waveforms and use these methods in section
\ref{sec:bank_construction} to create our template banks. In section
\ref{sec:bank_validation} we validate our template banks against the
aligned-spin signal models they are constructed to detect. In section
\ref{sec:resultsII_generic} we assess the performance of non-spinning template 
banks to search for generic \ac{NSBH} signals and assess the performance of 
aligned-spin template banks to detect the same signals. We conclude in section 
\ref{sec:conclusion}. Throughout this work we will use $G = c = 1$.

\section{A population of NSBH binaries}
\label{sec:nsbhpop}

In this section, we describe our large simulated set of \ac{NSBH} binaries. 
This is used to assess the loss in detection rate when using
non-spinning and
aligned-spin template banks to search for generic \ac{NSBH} binaries. To
construct this set we incorporate current astrophysical knowledge to choose the
distribution of masses and spins. However, this astrophysical knowledge is 
limited due to the fact that no \ac{NSBH} binaries have been directly 
observed. Nevertheless, both
\acp{NS} and \acp{BH} have been observed in other binary systems, and these
observations can be used to make inferences about the mass and spin
distributions that might be expected in \ac{NSBH} binaries.
We begin by giving the distributions that we use in this work, before 
describing the astrophysical knowledge that motivated these choices.

We simulate 100,000 \ac{NSBH}
binaries with parameters drawn from the following distribution.
The black hole mass is chosen uniformly between 3 and 15 solar masses;
the neutron star mass is chosen uniformly between 1 and 3 solar masses; the
black hole dimensionless spin magnitude is chosen uniformly between 0 and 1 and
the neutron star dimensionless spin magnitude is chosen uniformly between 0 and
0.05. The initial spin orientation for both bodies, the source orientation and
the sky location are all chosen from an isotropic distribution.

Black holes observed in X-ray binaries can be used to estimate the \ac{BH}
mass distribution, though it is difficult to disentangle the individual masses
and inclination angle with only electromagnetic observations~\cite{Ozel:2010su}.
Using a population of $\sim20$ low-mass X-ray binary systems with estimated 
masses, two separate works found that a \ac{BH} mass distribution of $7.8 \pm 
1.2 M_{\odot}$ fits the observed data well~\cite{Ozel:2010su,Farr:2010tu}. 
There is evidence that there is a ``mass gap'' between $3M_{\odot}$ and 
$5M_{\odot}$ where \acp{BH} will not form~\cite{Ozel:2010su,Farr:2010tu}, 
although this may be due to observational bias~\cite{Kreidberg:2012ud}. When 
high-mass X-ray binary systems are considered the mass distribution increases 
to $9.2012 \pm 3 M_{\odot}$, although a Gaussian model is a poor fit for these 
systems~\cite{Farr:2010tu}. Evidence exists for a stellar mass black hole with 
mass $> 20 M_{\odot}$ in the IC 10 X-1 x-ray 
binary~\cite{Prestwich:2007mj,Silverman:2008ss}. We choose to use a uniform 
range of 3 to 15 solar masses for the black holes in our \ac{NSBH} signal 
population. This is partly motivated by the considerations above, and partly by 
our concern of the validity of inspiral-only, point particle waveform models 
for high-mass \ac{NSBH} systems.
Observations of black hole spin have found spin values that span the minimum and
maximum possible values for Kerr black holes~\cite{Miller:2009cw}, therefore we 
use a uniform black-hole spin distribution between 0 and 1.

Observations of \acp{NS} in binary systems other than \ac{NSBH} binaries can be
used to estimate the \ac{NS} mass distribution. Using a
population of 6 \ac{BNS} systems with well constrained masses,
Ozel et al.~\cite{Ozel:2012ax}
found that the \ac{NS} mass distribution was well fitted by $1.33 \pm 0.05
M_{\odot}$, in agreement with Kiziltan et al.'s result
of $1.35 \pm 0.13 M_{\odot}$~\cite{Kiziltan:2010ct}. However, non-recycled
\acp{NS} in eclipsing high-mass binaries, as well as slow
pulsars, are found to have a much wider mass distribution of $1.28 \pm
0.24 M_{\odot}$~\cite{Ozel:2012ax}. Recycled \acp{NS} are found to have a
higher range of masses, $1.48 \pm 0.2 M_{\odot}$, due to
accretion~\cite{Ozel:2012ax}. However, it is expected that the black hole would
form first in the vast majority of cases, which would remove the
possibility of recycling.
There is also evidence for a \ac{NS}
with a mass as high as $\sim 3 M_{\odot}$ \cite{Freire:2007jd}, which is very
close to the theoretical upper limit on a \ac{NS}
mass of $\sim3.2 M_{\odot}$ \cite{Rhoades:1974fn}. While a conservative choice, 
we choose to use a uniform mass distribution between 1 and 3 solar masses for 
the \acp{NS} in our \ac{NSBH} signal population.

The magnitude of the dimensionless spin, $\bm{\chi} = {\bm{S}/ 
{m}^2}$, of
a neutron star cannot be larger than $\sim$ 0.7 \cite{Lo:2010bj} as the
neutron star would break apart under the rotational force.
However, it is rather
unlikely that \ac{NS} spins will have values as large as this in \ac{NSBH}
systems. At birth, neutron star spins are believed to be in the range 10 -
140 ms, corresponding to $\chi < 0.04$~\cite{Lorimer:2008se,Mandel:2009nx}.
Recycled neutron stars can have larger spin values~\cite{Bildsten:1997vw},
however they are unlikely to have periods less than
1~ms~\cite{Chakrabarty:2008gz}, corresponding to a
dimensionless spin of $\chi \sim 0.4$. The fastest spinning recycled neutron
star observed in a \ac{BNS} binary has a spin period of only 
23~ms~\cite{Burgay:2003jj}. As astrophysical observations seem to suggest that 
large neutron spins will be unlikely in \ac{NSBH} binaries we choose a uniform 
\ac{NS} spin distribution between 0 and 0.05.

\section{Waveform models}
\label{sec:waveform_model}

Matched-filter searches require an accurate model of compact binary mergers.
In a companion work we investigate the agreement of different waveform
families in the \ac{NSBH} region of parameter space and find a considerable
disagreement between waveforms produced by different waveform models, which
will reduce detection efficiency~\cite{Nitz:2013mxa}.

In this work we wish to investigate the effects of spin, especially spin-induced
precession, while understanding and mitigating any bias in our results due to 
the choice of waveform approximant. We therefore run all our simulations using 
two waveform approximants; TaylorT2~\cite{Damour:2000zb} and 
TaylorT4~\cite{Buonanno:2002fy}.

\ac{PN} waveforms, such as TaylorT2 and TaylorT4 are constructed by solving the
\ac{PN} equations of motion to obtain the binary orbits. It is assumed that the
binary evolves adiabatically through a series of quasi-circular orbits. This is
a reasonable assumption as it is expected that the emission of gravitational
radiation will circularize the orbits of isolated binaries~\cite{Peters:1964zz}. 
The
equations of motion then reduce to series expansions of the center-of-mass
energy $E(v)$ and the gravitational-wave flux $\mathcal{F}(v)$, which are
expanded as a power series in the orbital velocity $v$:
%
\begin{align}
\label{ref:PNeqs}
E(v) &= E_{\mathrm{N}} v^2 \left(1+\sum_{n=2}^{6}E_i v^i\right), \\
\mathcal{F}(v) &= F_{\mathrm{N}} v^{10} \left(1+\sum_{n=2}^{7}
\sum_{j = 0}^{1}F_{i,j} v^i \log^j v\right).
\end{align}
%
The various coefficients ($E_N$,$E_i$,$\mathcal{F}_N$,$\mathcal{F}_i$) are
reviewed in \cite{Arun:2008kb,Buonanno:2009zt}. For terms involving the orbital
contribution, the center-of-mass energy and gravitational wave flux are known 
to 3.5\ac{PN} order ($n=7$ in the parenthesis of \ref{ref:PNeqs})
\cite{Wiseman:1993aj,Blanchet:1995fg,Blanchet:1995ez,Blanchet:1996pi,
Blanchet:2001ax, Blanchet:2004ek}. For terms
involving the spin of the objects, the expansions of the energy and
flux are complete to 2.5 \ac{PN} order ($n=5$ in the parenthesis of 
\ref{ref:PNeqs})
\cite{Kidder:1992fr,Kidder:1995zr,Arun:2008kb}. In recent work,
terms relating to the coupling between the component spins and the orbit have
also been computed to 3.5 \ac{PN} order \cite{Blanchet:2012sm,Bohe:2013cla}. We
choose not to use these terms in this work because terms relating to the
spin(1)-spin(2), quadrupole-monopole and self-spin contributions are not yet
known at 3 \ac{PN} order, so we restrict the spin-related terms to 2.5 \ac{PN}
where these terms are fully known. We do not expect these terms to change the 
main conclusions of the work as these additional phase evolution terms will 
have little effect on the precessional evolution of a system.

The orbital phase, $\phi$ is then obtained via the energy balance equation
%
\begin{equation}
 \frac{dE}{dt} = - \mathcal{F}
\end{equation}
%
and by
%
\begin{equation}
  \frac{d\phi}{dt} = \pi f.
\end{equation}
%
Here the gravitational wave frequency $f$ is given by twice the orbital phasing
frequency, and is related to the orbital velocity by $v = (\pi M f)^{1/3}$ 
where $M$ denotes the total mass of the binary.

The various approximants are constucted via \emph{different} ways of
obtaining the gravitational wave phase from the equations above.

\subsection{TaylorT2 and TaylorF2}
\label{ssec:taylort2}

The TaylorT2 approximant is constructed by first calculating
%
\begin{equation}\label{eq:t2}
 B(v) = \left[ \frac{E'(v)}{-\mathcal{F}(v)} \right].
\end{equation}
%
Here $[X]$ is used to indicate that $X$ is calculated by first expanding it
as a Taylor series. Then orbital terms larger
than 3.5\ac{PN} and spin terms larger than 2.5\ac{PN} are discarded. This is 
because terms of this order would also depend on unknown terms in the 
expansion of the center-of-mass energy and the gravitational wave phase.
As $B(v) = dt / dv$ the gravitational wave phase is therefore obtained 
according to
%
\begin{equation}\label{eq:phaset2}
\phi(v) = \int \frac{v^3}{M} B(v) dv,
\end{equation}
%
which can be integrated analytically. In the same manner $t(v)$ can be 
calculated according to
%
\begin{equation}
 t(v) = \int B(v) dv.
\end{equation}
%
$\phi(v)$ and $t(v)$ can then be numerically inverted to obtain $\phi(t)$ and 
$v(t)$, which are used to construct the waveform.

When constructing a TaylorT2 waveform, one begins at a fiducial 
starting frequency, chosen to be smaller than the lowest frequency over which to 
perform the matched-filter. In this work, we use $14$Hz as the starting 
frequency. The waveform is terminated when the frequency reaches the 
\ac{MECO}, which is the point where
%
\begin{equation}
\frac{dE(v)}{dv} = 0.
\end{equation}

The TaylorF2 approximant is a frequency domain equivalent of the TaylorT2
approximant and is constructed using the stationary phase approximation
\cite{Sathyaprakash:1991mt,Cutler:1994ys,Droz:1999qx,Blanchet:2006zz}.
The TaylorF2 waveforms can be expressed as an analytic expression of the form
%
\begin{equation}
 \tilde h(f) = A(f;\mathcal{M},D_L\theta_x) e^{ - i \Psi(f;\lambda_i)},
\end{equation}
%
where $\tilde h(f)$ denotes the Fourier transform of $h(t)$, the time domain
gravitational-wave strain, $\mathcal{M}$ denotes the chirp mass, $D_L$ the 
luminosity distance to the source and $\theta_x$ describes the various 
orientation angles that only affect the
amplitude and overall phase of the observed gravitational
waveform~\cite{Allen:2005fk}. The phase $\Psi$ is given by
%
\begin{equation} \label{eq:phase_exp}
\Psi = 2 \pi f t_c - \phi_c(\theta_x) + 
\sum_{i = 0}^{7} \sum_{j = 0}^{1} \lambda_{i, j} f^{(i-5)/3} \log^j f,
\end{equation}
%
where $t_c$ is the coalescence time and $\phi_c$ is a constant phase offset. The
$\lambda$ terms give the various coefficients of the orbital phase,
which are summarized in \cite{Arun:2008kb,Buonanno:2009zt}. TaylorF2 waveforms
are usually terminated at the frequency corresponding to the \ac{ISCO} of a
non-spinning system with the given masses \cite{Allen:2005fk}.

\subsection{TaylorT4 and TaylorR2F4}
\label{ssec:taylort4}

In contrast to the TaylorT2 approximant, the TaylorT4 approximant,
introduced in~\cite{Buonanno:2002fy} is formed by calculating
%
\begin{equation}\label{eq:t4}
\frac{dv}{dt} = \left[ \frac{-\mathcal{F}(v)}{E'(v)} \right] = 
A(v).
\end{equation}
%
Similar to the TaylorT2 approximant, orbital terms larger than 3.5\ac{PN} and
spin terms larger than 2.5\ac{PN} are discarded from $A(v)$. This is
numerically solved to obtain $v(t)$ which can then be used to obtain the
gravitational-wave phase. The TaylorT4 approximant uses the same start and
termination conditions as the TaylorT2 approximant.

The TaylorR2F4 approximant, introduced in~\cite{Nitz:2013mxa}, is a
frequency-domain analytical approximation of the TaylorT4 waveform model. It is
constructed in the same manner as TaylorF2, however it uses
%
\begin{equation}
\frac{dt}{dv} = \left[ \frac{1}{A(v)} \right]
\end{equation}
%
instead of Eq.~(\ref{eq:t2}). In this case, while $A(v)$ is restricted as
described above, $1 / A(v)$ is truncated to a
higher order in $v$. The additional ``partial'' terms that are obtained in the
resulting \ac{PN} expansion describe the difference between the TaylorT2 and
TaylorT4 models. It has empirically been found that TaylorR2F4 matches best 
with TaylorT4
when $1 / A(v)$ is expanded to 4.5\ac{PN} order or 6\ac{PN} order
\cite{Nitz:2013mxa}. We only consider these two expansions of TaylorR2F4 in this
work.

\section{Method for assessing the performance of NSBH searches}
\label{sec:bank_testing}

In this section we describe the methods we use to assess the efficiency of
template banks and the terminology that we will use in the rest of this work.
The ``overlap'' between two waveforms $h_1$ and $h_2$ is defined as
%
\begin{equation}
 \mathcal{O}(h_1,h_2) = (\hat{h}_1|\hat{h}_2) =
\dfrac{(h_1|h_2)}{\sqrt{(h_1|h_1)(h_2|h_2)}},
\end{equation}
%
where $(h_1,h_2)$ denotes the noise-weighted inner product
%
\begin{equation}
(h_1|h_2) = 4 \, \mathrm{Re}
\int^{\infty}_{f_{\mathrm{min}}}\dfrac{\tilde{h}_1(f)\tilde{h}_2^*(f)}{S_n(f)} 
df.
\end{equation}
%
Here, $S_n(f)$ denotes the one sided \ac{PSD} of the noise in the
interferometer. In this work, we model $S_n(f)$ with the \ac{aLIGO}
zero-detuned, high-power design sensitivity curve~\cite{Harry:2010zz} and use a
lower frequency cutoff, $f_{\mathrm{min}}$, of 15Hz.

As gravitational wave searches for binary mergers analytically maximize over an
overall phase and time shift, we define the ``match'' between two waveforms
to be the overlap maximized over a phase and time shift
%
\begin{equation}
\mathcal{M}(h_1,h_2) =
\underset{\phi_c,t_c}{\max}(\hat{h}_1|\hat{h}_2(\phi_c,t_c)).
\end{equation}
%
One can understand this match as the fraction of the optimal \ac{SNR} that would
be recovered if a template $h_1$ was used to search for a signal $h_2$.

We define the ``fitting-factor'' between a waveform $h_s$ with unknown
parameters
and a bank of templates $h_b$ to be the maximum match between $h_s$ and all the
waveforms in the template bank~\cite{Apostolatos:1995pj},
%
\begin{equation}
\mathrm{FF}(h_s) = \max_{h \in \{h_b\}} \mathcal{M}(h_s,h).
\end{equation}
%
The ``mismatch''
%
\begin{equation}
\mathrm{MM} = 1 - \mathrm{FF}(h_s)
\end{equation}
%
describes the fraction of \ac{SNR} that is lost due to the fact that the
template in the bank that best matches $h_s$ will not match it exactly due to
the discreteness of the bank and due to any disagreement between the waveform 
families used to model the templates and the signals. In previous searches of 
LIGO and Virgo data using
non-spinning template banks, the banks of signals were constructed so that the
fitting factor would be greater than 0.97 for any non-spinning signal within
the parameter space \cite{Babak:2012zx}. This was chosen as a balance between
detection efficiency and computational cost. We also construct our 
aligned-spinning banks with this criterion.

When a set of fitting factors have been calculated one can quote an ``average 
fitting factor'' by taking the mean over all the values
%
\begin{equation}
 \textrm{FF}_{\textrm{av}} =  \left\langle \textrm{FF}
\right\rangle,
\end{equation}
%
where $\left\langle X \right\rangle$ denotes the mean average of $X$.
However, this measure can often be misleading.
The \ac{aLIGO} detectors have a direction-dependent and
orientation-dependent sensitivity. Systems that are poorly aligned with respect
to the detector may not have sufficient \ac{SNR} to be detected, regardless of
the fitting factor.
To account for this we make use of the ``effective fitting factor'',
first defined in \cite{Buonanno:2002fy} as
%
\begin{equation}
 \textrm{FF}_{\textrm{eff}} = \left( 
 \frac{ \left\langle \textrm{FF}^3 \sigma_i^3 \right\rangle }{\left\langle
\sigma_i^3 \right\rangle} \right)^{1/3}.
\end{equation}
%
Here $\sigma_i = \sqrt{(h_i|h_i)}$, which describes the optimal \ac{SNR}
of $h_i$. The cube of the effective fitting factor gives, above an
arbitrary \ac{SNR} threshold, the ratio between the fraction of \ac{NSBH}
signals that would be recovered with the discrete template bank that was used
and a theoretical continuous template bank that would recover 100\% of signal
power for \emph{any} \ac{NSBH} waveform. We therefore define the ``signal
recovery fraction'' as $\textrm{FF}_{\textrm{eff}}^3$.

\section{A new algorithm for constructing template banks of aligned-spin NSBH 
waveforms}
\label{sec:bank_method}

In \cite{Brown:2012qf} we proposed a method for generating a
geometrically-placed bank of aligned-spin
systems that can be used to search for \ac{BNS} systems in the advanced detector
era. In this section we adapt the methods presented in that work to the case of
\ac{NSBH} systems and describe how to generate template banks that can recover
aligned-spin \ac{NSBH} waveforms. These banks are applicable for waveforms
modelled using either the TaylorT2 approximant or the TaylorT4 approximant.

A bank of templates should be placed such that any putative signal
within the parameter space of interest would be recovered with a loss in SNR
that is always
less than some predefined value, usually taken to be 3\%
\cite{Poisson:1995ef,Owen:1995tm,Owen:1998dk,Babak:2006ty,
Cokelaer:2007kx,Babak:2012zx}.
To determine the maximum spacing between templates that meets this criterion,
the parameter space metric is used. This approximates the distance between any
two points that are close in the parameter space \cite{Owen:1995tm}
%
\begin{equation}
\label{eq:cbc_metric2}
\mathcal{O}(h(\bm{\theta}),h(\bm{\theta}+\delta\bm{\theta})) =
  1 - \sum_{ij} g_{ij}(\bm{\theta}) \,\delta\theta^i \,\delta\theta^j,
\end{equation}
%
with the metric given by
\begin{equation}
\label{eq:cbc_metric}
g_{ij}(\boldsymbol{\theta}) = - \frac{1}{2} \frac{\partial^2
\mathcal{O}}{\partial \delta\theta^i \partial
\delta\theta^j} = \left(\frac{\partial h(\boldsymbol{\theta})}{\partial
\theta^i} \bigg|
\frac{\partial h(\boldsymbol{\theta})}{\partial \theta^j}\right).
\end{equation}
Here $\bm{\theta}$ describes the parameters of the signal, in this case the
masses and the spins. This is also commonly referred to as the Fisher metric. 

Obtaining an analytic solution for Eq. \ref{eq:cbc_metric} is much simpler in 
the frequency domain and therefore frequency-domain waveform models are 
commonly used when placing a bank of 
templates~\cite{Owen:1995tm,Owen:1998dk,Babak:2012zx}. We follow that approach 
and consider only frequency-domain metrics here. It is important to carefully 
consider which
coordinates to use as parameters when using this metric as an approximation to
the parameter space distance. If one were to naively use the masses and spins
directly as coordinates it
would result in a parameter space metric with a large amount of extrinsic
curvature, and Eq.~(\ref{eq:cbc_metric2})
would only be valid for small ranges of $\delta\theta^i$. In previous searches
for non-spinning systems,
the ``chirp times'' were used \cite{Owen:1998dk}, defined as,
%
\begin{subequations}
\begin{align}
 \tau_0 &= \frac{5}{128} \left(\pi M \right)^{-5/3} \eta^{-1} \\
 \tau_3 &= \frac{\pi}{4} \left(\pi M \right)^{-2/3} \eta^{-1},
\end{align}
\end{subequations}
%
as these are the two combinations of the masses that minimize extrinsic
curvature.

When the template waveforms include spin it is difficult to identify a
parameterization of the waveform for which the metric is locally flat.
Instead, in~\cite{Brown:2012qf} we constructed a metric
that uses the various coefficients of the expansion of the orbital
phase, given by the various $\lambda_i$ terms in Eq.~(\ref{eq:phase_exp}),
directly as coordinates. Using these coordinates, the parameter space is
globally flat. However, for the TaylorF2 metric including terms up to
3.5\ac{PN} order, the parameter space is 8-dimensional. The physical 
sub-space forms a 4-dimensional manifold within this parameter 
space.

To deal with the increased dimensionality of the space we perform two
coordinate transformations~\cite{Brown:2012qf,Ohme:2013nsa}. These two 
coordinate
transformations map points from the $\lambda_i$ coordinates into a
Cartesian coordinate system where the principal directions are mapped using
coordinates denoted by $\xi_i$. Specifically, the first coordinate 
transformation uses the eigenvectors and
eigenvalues of the $\lambda_i$ metric to transform to a Cartesian
coordinate system. A Principal Component Analysis is then performed to rotate
into the frame given by the principal directions of the parameter space. In 
this Cartesian coordinate system of principal directions we can
assess the ``effective dimension'' of the parameter space; i.e., the number of
directions in which templates actually need to be placed in order to achieve the
desired coverage. For the case of the \ac{BNS} parameter space with the 
\ac{aLIGO} \ac{PSD} we found that many of the directions had an extremely small 
extent and
could be neglected entirely. We found that a 2-dimensional lattice could
efficiently cover the entire space of aligned-spin \ac{BNS}
waveforms~\cite{Brown:2012qf}.

Our geometrical placement method is not specific to the \ac{BNS} area of the
parameter space. However, some modifications to the method were necessary when
placing a template bank of \ac{NSBH} waveforms. Our \ac{BNS} aligned-spin
template bank, as described in~\cite{Brown:2012qf}, was given in terms of the
positions of the points in the 8-dimensional Euclidean parameter space, $\xi_i$.
These points do not correspond directly to physical masses and spins. For this
study we want to use time domain template families and therefore we
must translate the bank into physical parameters. However, if a set of $\xi_i$ 
values is given it will, in general, not be possible to find a set of masses 
and spins that give the exact $\xi_i$ values. As 
templates are normally placed in a 2-dimensional lattice, we need only to 
find a physical point that has the corresponding values of $\xi_1$ and $\xi_2$ 
and \emph{any} value of the other $\xi_i$ values that correspond to a waveform 
within the physically allowed manifold. For some cases where a 2-dimensional 
lattice is not sufficient to cover the space we will also specify values of 
$\xi_3$ and $\xi_4$. We attempt to find a 
physical solution that is sufficiently close to the desired point using a
numerical solution. We generate a large set of points in
the mass and spin space and map these points to the $\xi_i$ parameters. For 
each template we then find the closest point from our large 
set of physical points.
We then proceed to iteratively test physical points in the vicinity to find a
match of at least 0.9999 with the intended position.
If the template is within the physically allowed parameter space we can 
generally find a physical point that has the desired match with the intended 
$\xi_i$ point.
Templates on the boundaries of the space, might have an
overlap as low as $\sim 0.97$ with the edge of the physical parameter space.
Our method pushes such points back into
the desired physical space thereby providing a slight \emph{improvement} in the
bank coverage. This method also provides an easy method to determine the extent 
of the physical space: if \emph{no} physical point is found with 0.97 or higher 
match with the $\xi_i$ position then that point is not within the physical 
extent of the parameter space and no template needs to be placed there.

The downside to our brute-force numerical method is that it is currently not
computationally efficient; generating a bank with this numerical technique can 
take $O(10)$ hours when running on $\sim 500$
CPU cores. The cost of placing a bank using this method, however, is negligible
when compared to the cost of filtering data against a bank of templates if a 
single bank is used to filter O(days) of data. If the bank is regenerated every 
hour, as in previous searches of LIGO and Virgo data~\cite{Babak:2012zx}, this 
cost would not be negligible.
We note that it should be possible to optimize our implementation to obtain a 
significant speed increase over what we quote above.

The TaylorF2 metric can be used to place a bank of waveforms modelled with the
TaylorT2 approximant. However, we also require that our template placement
algorithm place a bank of waveforms that can detect aligned-spin signals
modelled using TaylorT4 with no more loss in \ac{SNR} than that specified by 
the minimal match of the bank. This will allow us to investigate the efficiency 
of aligned-spin banks to search for precessing \ac{NSBH} signals using two 
waveform models. Using two models will help to mitigate any bias in our 
results that arises due to the choice of waveform approximant.
We investigate the distribution of fitting factors when using a template bank
constructed using the TaylorF2 metric to search for aligned-spin TaylorT4
\ac{NSBH} signals in section \ref{sec:bank_validation} and find that this would
result in a reduction of sensitivity. We therefore make use of
a metric that models the TaylorT4 waveform well. To do this we use the
TaylorR2F4 waveform model. We have found that restricting the TaylorR2F4 model
to terms no larger than 4.5\ac{PN} and placing a bank of templates using the
ensuing metric is sufficient to cover the TaylorT4 parameter space. This is
a 12-dimensional metric. We then perform the same rotations as for the TaylorF2
metric to identify the $\xi_i$ directions for our TaylorR2F4 parameter
space and proceed in the same manner as described above.

In contrast to \ac{BNS} mergers, \ac{NSBH} systems can merge in
the sensitive band of the advanced detectors. Existing non-spinning
template placement algorithms
\cite{Poisson:1995ef,Owen:1995tm,Owen:1998dk,Babak:2006ty,
Cokelaer:2007kx}, as well as our aligned-spin algorithm must use the same 
termination frequency when modelling waveforms across the parameter space. 
The standard approach is to assume that the waveforms will follow the TaylorF2, 
or TaylorR2F4, evolution up to the Nyquist frequency, usually 2048Hz. For 
\ac{BNS} systems, the merger generally occurs above 1000Hz where the 
sensitivity of
gravitational wave interferometers falls off and therefore little power is
incurred between 1000Hz and Nyquist. Even a $(3 + 3)M_{\odot}$ \ac{BNS}
has an \ac{ISCO} with a frequency of 730Hz. In contrast, a $(15 + 3)M_{\odot}$
\ac{NSBH} system has an \ac{ISCO} frequency at 240Hz. We must therefore
consider what frequency cutoff is most appropriate to use when placing a bank
of \ac{NSBH} waveforms.

We found that using an upper frequency cutoff that is higher than the waveform's
termination frequency results in overcoverage in the parameter space. This 
result is expected as the sub-dominant \ac{PN} terms can have a
significant effect in the late part of the evolution, causing
systems with the same chirp masses but different spins and mass ratio to diverge
faster. Therefore we use an upper frequency cutoff of 1000Hz for all waveforms
within the \ac{NSBH} parameter space to generate a template bank that will cover
to the desired minimal match. However, as this template bank will overcover
at least the high mass end of the parameter space we also investigate the
efficiency of banks placed with smaller upper frequency cutoffs in section
\ref{ssec:stoch_fup_compare}. This choice will be an important consideration
in the advanced detector era given limits on computational power for conducting
\ac{NSBH} searches.

\section{Constructing template banks of aligned-spin NSBH waveforms with our 
new algorithm}
\label{sec:bank_construction}

\begin{table*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\begin{tabular}{c | c | c | c}
 Template bank & Approximant & Waveform cutoff frequency & Number of templates
in bank \\ \hline \hline
 Geometric non-spinning bank & TaylorF2 & 1000Hz & 117,632 \\
 Geometric non-spinning bank & TaylorR2F4 (up to 4.5PN) & 1000Hz & 99,309 \\
 Geometric aligned-spin bank & TaylorF2 & 1000Hz & 817,460 \\
 Geometric aligned-spin bank & TaylorF2 & 400Hz & 432,537 \\
 Geometric aligned-spin bank & TaylorF2 & 240Hz & 282,090 \\
 Stochastic aligned-spin bank & TaylorF2 & Dynamic & 971,105 \\
 Geometric aligned-spin bank & TaylorR2F4 (up to 4.5PN) & 1000Hz & 1,100,277 \\
 Geometric aligned-spin bank & TaylorR2F4 (up to 4.5PN) & 400Hz & 504,132 \\
 Geometric aligned-spin bank & TaylorR2F4 (up to 4.5PN) & 240Hz & 260,325 \\
 Stochastic aligned-spin bank & TaylorR2F4 (up to 4.5PN) & Dynamic & 1,327,175\\
\end{tabular}
\caption{\label{tab:banksizes}
The sizes of the various template banks that are used in this work. All of these
banks are valid for
aligned-spin \acp{NSBH} with BH mass $\in [3,15) M_{\odot}$; NS mass $\in 
[1,3)M_{\odot}$; BH
dimensionless spin $\in [-1,1]$;
NS dimensionless spin $\in [-0.05,0.05]$. For all banks the \ac{aLIGO}
zero-detuned, high-power noise curve is used with a lower frequency cutoff of
15Hz.
}
\end{minipage}
\end{table*}

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure1A.png}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure1B.png}
\caption{\label{fig:bankF2depths}
The depth of the physically possible range of $\xi_3$ (left) and $\xi_4$ (right)
values as a function of
$\xi_1$ and $\xi_2$ shown for the TaylorF2 \ac{NSBH} parameter space.
The $\xi_i$ coordinates have been scaled
such that one unit corresponds to the coverage diameter of a template
at 0.97 mismatch. Shown using the zero-detuned, high-power advanced LIGO
sensitivity curve with a 15Hz lower frequency cut off
and a 1000Hz upper frequency cut off.}
\end{minipage}
\end{figure*}

We begin by creating a template bank using the TaylorF2 parameter space metric.
We first explore the space to assess the effective dimensionality and to
determine whether the 2-dimensional placement used to cover the \ac{BNS}
space in~\cite{Brown:2012qf} is applicable to the \ac{NSBH}
space. We do this by creating a set of $10^7$ points drawn uniformly from the
chosen range of \ac{NSBH} masses and spins. We then transform these points
into the $\xi_i$ coordinates. In Fig.~\ref{fig:bankF2depths} we show the
extent of the dominant two directions ($\xi_1$ and $\xi_2$). The color shows,
respectively, the depth of the third direction ($\xi_3$) and the fourth
direction ($\xi_4$). The fifth and subsequent directions are, as in the \ac{BNS}
space, small enough to be ignored completely.

From these plots we can see that the extent of the space in all but the $\xi_1$
and $\xi_2$ directions is small in most regions. In these areas a
2-dimensional lattice of template points would suffice to cover the parameter
space. However, there is a
small region in the center of the parameter space where the depth of the third
direction is not negligible. Therefore, to cover this space we
follow~\cite{Brown:2012qf} and initially place a 2-dimensional lattice in the
$\xi_1$, $\xi_2$ coordinates. Then, where necessary, templates are stacked in
the $\xi_3$ direction. The density of this stacking is chosen such that the loss
in match due to the depth of the third direction can never be larger than 0.01.
As the 2-dimensional lattice is placed to ensure that matches will not be less
than 0.97 in a 2-dimensional plane, and as each direction in our Euclidean 
parameter space is orthogonal, there are therefore regions of the parameter
space where the fitting factor can be as low as 0.96. However, these regions are
small and the mean fitting factor, as we will show, is still much larger than
0.97. This bank, constructed using the TaylorF2 parameter space metric, contains
801,183 templates, of which 134,807 were added by the stacking process. For
ease of comparison Table \ref{tab:banksizes} gives the sizes and properties of
all the banks that are used in this work.

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure2A.png}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure2B.png}
\caption{\label{fig:bankF4depths}
The depth of the
physically possible range of $\xi_3$ (left) and $\xi_4$ (right) values as a
function of
$\xi_1$ and $\xi_2$ shown for the TaylorR2F4 \ac{NSBH} parameter
space. The $\xi_i$ coordinates have been scaled
such that one unit corresponds to the coverage diameter of a template
at 0.97 mismatch. Shown, using the zero-detuned, high-power advanced LIGO
sensitivity curve with a 15Hz
lower frequency cut off and a 1000Hz upper frequency cut off.}
\end{minipage}
\end{figure*}

We next construct a bank of template waveforms using the TaylorR2F4 parameter
space metric.
We begin by exploring the parameter space to assess the effective
dimensionality.
In Fig.~\ref{fig:bankF4depths} we show the depths of the $\xi_3$ and $\xi_4$
directions as a function of $\xi_1$ and $\xi_2$ for the TaylorR2F4 parameter
space. We immediately notice that the degeneracies present in the TaylorF2
space, which allow us to use a 2-dimensional placement,
are much weaker in the TaylorR2F4 parameter space. For this space
there is substantial depth in the third direction. In one small region it is
wider than 10 template diameters. The median depth in this direction, however,
is only one template diameter.

If the depth in the third direction was larger in all regions, the most
efficient placement scheme would be to place a template bank in a 3-dimensional
$A_n^{\star}$ lattice \cite{Conway:1993}. However, in regions where the depth of
the 3rd direction is small, the 3-dimensional lattice, when flattened into the 
2-dimensional space, would cause an overcoverage. We therefore tried both a
3-dimensional lattice placement and a 2-dimensional placement, followed
by stacking in the 3rd direction as we used for the TaylorF2 bank. Additionally,
unlike in the TaylorF2 space, the depth of the fourth dimension is not
negligible. However, as in most places the width in that direction is small, the
stacking technique can also be used to cover the depth of the 4th dimension when
needed.

When we choose to employ a 3-dimensional lattice we find that 1,805,036
templates are needed to cover the space, 90,463 of which were added due to
stacking in the 4th direction. In contrast, when we use a hexagonal lattice
followed by stacking in both the 3rd and 4th directions we find that 1,100,277
templates are needed, of which 741,626
were added by the stacking process. It may seem surprising that the 2-d
hexagonal lattice requires less templates
than the 3-d $A_n^{\star}$ lattice. In fact, it would still require less
templates even if the depth of the third
direction was large in all regions of the space. The reason for this is that the
$A_n^{\star}$ placement \emph{guarantees}
that all points within the 3-dimensional space will have a fitting factor of at
least 0.97. With the
hexagonal placement followed by stacking, there are points in the space where
the fitting factor can be as low as 0.96
(when the depth of the 4th dimension is significant this can be as low as 0.95).
If we were to require that all points
within the space \emph{must} have a fitting factor of at least 0.97, our
hexagonal lattice would need to be placed
to a minimal match of 0.98.
For comparison, we generated a 3-dimensional lattice with a minimal-match of 
0.96, this bank contained 1,175,523 templates. The 3-dimensional lattice is 
still less efficient than the 2-dimensional lattice. This can be attributed, as 
described above, to the fact that the depth of the 3rd direction is not large 
in all areas of the parameter space. In some areas a 2-dimensional lattice, 
without any stacking, is
sufficient to cover the parameter space. An alternative approach might be to use 
a 3-dimensional lattice of points only in regions where it is needed and a 
2-dimensional lattice elsewhere, we did not investigate that here. For the 
simulations in the following sections, we use the hexagonal lattice with
stacking as the method for placing banks of templates for the TaylorT4
approximant.

\section{Results I: Validating the new template bank placement for 
aligned-spin systems}
\label{sec:bank_validation}

In this section we demonstrate that our aligned-spin template banks acheive the
level of coverage they are constructed for when used to search for aligned-spin
signals. We also compare our banks to banks generated using a stochastic
placement algorithm~\cite{Harry:2009ea,Babak:2008rb,Manca:2009xw,Ajith:2012mn}
and show that our method acheives the same level of coverage with fewer
templates. 

\begin{figure}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure3.pdf}
\caption{\label{fig:bankF2verification}
Fitting factor between a set of aligned-spin \ac{NSBH} signals and our
geometrically placed aligned-spin template bank placed using the TaylorF2
metric. Shown when both templates and signals are generated using
the TaylorF2 approximant (gray solid line) and when both are modelled with
TaylorT2 (gray
dashed line). Also shown when the signals are modelled with TaylorT2 and the
templates modelled
with TaylorF2 waveforms terminated at ISCO (black dotted line) and TaylorF2
waveforms terminated at MECO (black dot-dashed line). Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{figure}

\begin{figure}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure4.pdf}
\caption{\label{fig:bankF4verification}
Fitting factor between a set of aligned-spin \ac{NSBH} signals and our
geometrically placed aligned-spin template bank placed using the TaylorR2F4
metric. Shown are comparisons between
TaylorT4 waveforms, TaylorR2F4 waveforms
including terms to 4.5PN order and TaylorR2F4 waveforms including terms to 6PN
order. Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{figure}

To verify the performace of our aligned-spin template banks we compute the
fitting factors between the banks and a set of 100,000 aligned-spin \ac{NSBH}
waveforms. These waveforms are drawn from the
distribution that we describe in section \ref{sec:nsbhpop}, except that the
spins are all aligned (or anti-aligned) with the orbital angular momentum.

In Fig.~\ref{fig:bankF2verification} we show the results of this test using
the template bank constructed with the TaylorF2 metric. We show results when
both template waveforms and signals are modelled using the TaylorF2
approximant, when both are modelled using the TaylorT2 approximant and when we
model the template waveforms with TaylorF2 and the signals with TaylorT2.
In both cases where the same waveform model was used almost all of the fitting
factors were greater than 0.97. The bank generation was successful.

The lowest matches in the TaylorF2 vs TaylorF2 results were in cases
where a system with low mass ratio was recovered with a template with a high
mass ratio, or vice-versa. These are systems where the degeneracy between the
spins and the mass ratio \cite{Baird:2012cu} causes
the phase evolution of the two systems to be very similar and therefore the
match predicted by the metric is higher than 0.97.
However, the system with the larger black hole mass will terminate at a 
significantly lower frequency than the system with the smaller black hole mass
and some power is lost due to the difference in termination frequencies, which
is not predicted by the metric.

The difference in termination conditions is also the reason why we see
comparitively poorer performance when using TaylorF2 waveforms, terminated
at the \ac{ISCO} frequency, to search for TaylorT2 signals. The TaylorT2
signals terminate when the evolution becomes unphysical,
either at the \ac{MECO} or where the frequency spuriously begins to drop. In
some cases, especially when the spins
are large, these can correspond to rather different termination frequencies. To
demonstrate this we also show the performance
of searching for TaylorT2 signals with TaylorF2 waveforms,
but where we terminate the TaylorF2 waveforms using the same cut-off frequency
that TaylorT2 waveforms would have at the given masses and spins.
This gives a much more comparable performance to the TaylorF2 vs TaylorF2
and TaylorT2 vs TaylorT2 cases.

In Fig.~\ref{fig:bankF4verification} we repeat this test using
the template bank constructed with the TaylorR2F4 metric, with terms restricted
to 4.5\ac{PN} order. We show results when the template waveforms and signals
are modelled with varying approximants. We use TaylorR2F4 with terms up to
4.5\ac{PN} order, TaylorR2F4 with terms up to 6\ac{PN} order and TaylorT4.
We can see from this figure that using TaylorR2F4 template waveforms
with terms only to 4.5\ac{PN} order would not be satisfactory when conducting
searches for signals modelled with the TaylorT4 approximant. However, we note
that when this bank is used with either TaylorT4 templates or TaylorR2F4
templates including terms up to 6\ac{PN} order the coverage is much better.
When TaylorT4 is used to model both the signals and the template waveforms we
find that $>99\%$ of the fitting factors are greater than
0.97. In this plot the TaylorR2F4 waveforms are terminated at
the same frequency (the \ac{MECO} frequency) as the TaylorT4 waveforms.

The TaylorR2F4 metric, with terms up to
4.5\ac{PN}, is sufficient to place
a bank of templates to cover waveforms modelled by the TaylorT4 approximant.
However, when performing the
matched-filtering the templates must be modelled with either TaylorT4 or
TaylorR2F4 with terms up to 6\ac{PN} order.

\begin{figure}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure5.pdf}
\caption{\label{fig:bankF2T4testing}
Fitting factor between a set of aligned-spin \ac{NSBH} signals modelled with the
TaylorT4 approximant and our template bank of aligned-spin signals placed using
the TaylorF2 parameter space metric. Shown are the fitting factors when the
templates used are modelled using the TaylorF2 approximant (grey solid line),
TaylorT2 (grey dashed line) and TaylorT4 (black dotted line). Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{figure}

In Fig.~\ref{fig:bankF2T4testing} we also show the performance of a bank
placed using the TaylorF2 metric to search for TaylorT4 aligned-spin signals.
We assess the performance when the templates are modelled using TaylorF2,
TaylorT2 and TaylorT4 approximants. Even when TaylorT4 is used to model both
template waveforms and signals, $10\%$ of signals are recovered with fitting
factors smaller than 0.95. The TaylorF2 metric does not acheive the desired
coverage for TaylorT4 waveforms. In a companion work we investigate how the 
disagreement of different waveform families in the \ac{NSBH} region of 
parameter space will reduce detection efficiency~\cite{Nitz:2013mxa}.

\subsection{Varying the upper frequency cutoff and comparison with stochastic
placement algorithms}
\label{ssec:stoch_fup_compare}

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure6A.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure6B.pdf}
\caption{\label{fig:bankfcutoff}
Fitting factor between a set of aligned-spin \ac{NSBH} signals
and a template bank of aligned-spin waveforms for varying values of the upper
frequency cutoff used in the construction metric. Shown for template banks
placed using the TaylorF2 metric and with both templates and signals 
modelled using the TaylorF2 approximant (left). Also shown for template banks
placed using the TaylorR2F4 metric and with both templates and signals 
modelled using the TaylorR2F4 approximant (right). The
performance of using a stochastically placed template bank with varying upper
frequency cutoff is also plotted. Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{minipage}
\end{figure*}

Filtering ${\sim}10^6$ templates against data from advanced
gravitational-wave detectors will require a large amount of computing power. It
would therefore be desireable if we could reduce the overcoverage that
is incurred in the high mass region of the parameter space when using an upper
frequency cutoff of 1000 Hz. An alternative ``stochastic'' placement scheme,
based on randomly picking points in the space and only retaining points which
are not close to points already in the bank
\cite{Harry:2009ea,Babak:2008rb,Manca:2009xw}, is capable of using an upper
frequency cutoff that varies with mass \cite{Ajith:2012mn}. However, this
method is known to pack templates more densely than a geometrical
lattice~\cite{Harry:2009ea}.
We found that using a stochastic method to cover this \ac{NSBH} space with the
same covering criterion required 971,105 (1,327,175) templates when using
the TaylorF2 (TaylorR2F4) metric to place the bank. In both cases this is $\sim
20\%$ larger than our geometric algorithm using a constant upper frequency
cutoff of 1000 Hz. It is also possible to generate the geometric bank with a
lower upper frequency cutoff. This will require less
templates, but will not reach the desired coverage in the lower mass regions of
the parameter space. In Fig.~\ref{fig:bankfcutoff} we compare the efficiency
of geometric banks placed using a 240Hz, 1000Hz and 400Hz upper frequency
cutoff. These correspond to roughly the lowest possible \ac{ISCO}
frequency, the highest and an ``average'' system. The sizes of these banks are
shown in Table \ref{tab:banksizes}. As expected we notice a number of systems
recovered with fitting factors less than 0.97 when the upper frequency cutoff is
reduced. We also compare with the performance of a
stochastic placement algorithm, which uses a varying upper frequency cutoff.
The performance of the
stochastic bank is very comparable to the 1000Hz bank when using the TaylorF2
metric. When using the TaylorR2F4 metric  the stochastic bank, which was placed
using $10^9$ seed points, seems to be struggling to achieve the necessary
coverage in certain regions of the space. As the stochastic placement algorithm
only uses a finite number of sample points, it is known that it can leave holes
in the parameter space, resulting in undercoverage~\cite{Harry:2009ea}.

We plan to adapt the geometric placement algorithm to allow the upper frequency
cutoff to vary over the space, however we leave this investigation for future
work. We note that the minimal match and \emph{lower} frequency cutoff of the
bank can also be modified to reduce the number of templates and balance the
computational cost~\cite{Keppel:2013yia}.

\section{Results II: Template bank performance when searching for generic NSBH 
signals}
\label{sec:resultsII_generic}

In this section we evaluate the efficiency of searching for generic
\ac{NSBH} systems using template banks of non-spinning waveforms. Template 
banks of non-spinning waveforms were used to search for \ac{NSBH} 
signals in data from LIGO and Virgo's most recent science runs 
\cite{Abbott:2009tt,Abbott:2009qj,Abadie:2010yba,Abadie:2011nz}.
We demonstrate that ignoring the effects of spin when conducting searches
for \ac{NSBH} systems in the advanced detector era will significantly decrease
the rate of \ac{NSBH} observations and impose a selection bias against systems
with large spins and large $m_{BH} / m_{NS}$. We then evaluate the efficiency 
of 
searching for generic \ac{NSBH} systems using our new template bank of 
aligned-spin waveforms. We calculate the improvement gained by using our new 
bank when compared to a non-spinning bank.

\subsection{Performance of non-spinning template banks when searching for 
generic
NSBH signals}
\label{sec:non_spinning}

We compute fitting factors between a set of 100,000 generic, precessing
\ac{NSBH} signals and a bank of non-spinning template waveforms. The
precessing signals are drawn from the distribution
that we describe in section \ref{sec:nsbhpop}.
To mitigate any bias that arises due to the choice of waveform approximant
we run the simulation twice. First we use the TaylorT2 approximant for both
signal and template waveforms and a template bank designed to obtain
a fitting factor of at least 0.97 for any TaylorT2 non-spinning signal.
The simulation was then repeated using the TaylorT4 approximant for both signal
and template waveforms and a bank designed with the same fitting factor
criterion for TaylorT4 signals. These banks were constructed using the methods
described to create aligned-spin banks in section \ref{sec:bank_construction}
but with the spins set to 0.

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure7A.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure7B.pdf}
\caption{\label{fig:aspineffectualness}
Fitting factor between a set of generic, precessing, NSBH signals and a
template bank of aligned-spin waveforms. Shown when both templates and signals
are generated using
the TaylorT2 approximant (black solid line) and the TaylorT4 approximant (black
dashed line).
Also shown when the templates are modelled using TaylorT2 and the signals are
modelled using TaylorT4 (black dotted line). For comparison the same results 
using a template bank of non-spinning waveforms are also plotted in grey. 
Plotted
over the full range of fitting factors (left) and zoomed in to show only
fitting factors greater than 0.9 (right). The
distribution that the NSBH signals are drawn from is described in section
\ref{sec:nsbhpop}. The template bank construction is described in section
\ref{sec:bank_construction}. Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{minipage}
\end{figure*}

The results of this simulation can be seen in 
Fig.~\ref{fig:aspineffectualness}. From this we can calculate the mean and 
median values of the fitting factor over the signal distribution that we used.
The mean fitting factor of the
signals is 0.82 (0.84) for the TaylorT2 (TaylorT4) approximant, while the median
fitting factor was 0.86 (0.88). In both cases the distributions have 
long tails, with some systems recovered with less than 30\% of their optimal
\ac{SNR}.
We also show results where we have modelled the templates using the TaylorT2
approximant and the signals using the TaylorT4 approximant. In this case
the mean fitting factor is 0.84 and the median is 0.87.
We notice that fewer signals are recovered with
high fitting factors ($> 0.95$) than in the other two cases, but we notice that
at lower values of fitting
factor the performance is very similar to the TaylorT4 vs TaylorT4 case.
The slight \emph{improvement}
of the TaylorT2 vs TaylorT4 case at lower fitting factors can be attributed to
the fact that the TaylorT2 bank is $\sim20\%$
larger than the TaylorT4 bank and therefore has more freedom to match
TaylorT4-modelled spinning signals. 

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure8A.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure8B.pdf}
\caption{\label{fig:nonspinavFF}
Average fitting factor between a set of generic, precessing, NSBH signals and a
template bank of non-spinning waveforms as a function of the component masses
(left) and as a function of the mass ratio and the black hole dimensionless spin
magnitude (right). Both the signals and the template waveforms are modelled
using the TaylorT4 approximant. The distribution that the NSBH
signals are drawn from is described in section \ref{sec:nsbhpop}.
Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{minipage}
\end{figure*}

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure9A.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure9B.pdf}
\caption{\label{fig:nonspinavFFT2}
Average fitting factor between a set of generic, precessing, NSBH signals and a
template bank of non-spinning waveforms as a function of the mass ratio and the
black hole dimensionless spin
magnitude (right). Shown when both the
template waveforms and signals are modelled with TaylorT2 (left) and when the
template waveforms are modelled with TaylorT2 and the signals are modelled with
TaylorT4 (right). The results in these plots are almost identical to each other 
and to the right panel of Fig.~\ref{fig:nonspinavFF}.
The distribution that the NSBH
signals are drawn from is described in section \ref{sec:nsbhpop}.
Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{minipage}
\end{figure*}

In Fig.~\ref{fig:nonspinavFF}, we show the mean fitting factor as a function
of the intrinsic parameters of the system when both templates and signals
were modelled with the TaylorT4 approximant. For comparison, in
Fig.~\ref{fig:nonspinavFFT2} we show the mean fitting factor as a function of
the spin magnitude and mass ratio for the TaylorT2 vs TaylorT2 results and the
TaylorT2 vs TaylorT4 results. In both cases the results are similar to the
TaylorT4 vs TaylorT4 case, which indicates that the results are not suffering
from a significant bias due to the choice of waveform approximant. However, we
note that when using TaylorT2 as the signal model, the performance of the
non-spinning banks is worse for high spin, unequal mass systems than when
using TaylorT4 as the signal model.

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure10A.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure10B.pdf}
\caption{\label{fig:nonspineffFF}
The signal recovery fraction obtained for a set of generic, precessing, NSBH
signals and a template bank of non-spinning waveforms as a function of the mass
ratio and the black hole dimensionless spin. Shown when both the
template waveforms and the signals are modelled with TaylorT2 (left) and when
both the template waveforms and the signals are modelled with TaylorT4 (right).
The distribution of the signal recovery fraction over the mass space is very 
similar to the distribution of average fitting factors shown in 
Figs.~\ref{fig:nonspinavFF} and \ref{fig:nonspinavFFT2}.
The distribution that the NSBH
signals are drawn from is described in section \ref{sec:nsbhpop}.
Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{minipage}
\end{figure*}

In Fig.~\ref{fig:nonspineffFF} we show
the signal recovery fraction as a function of the \ac{BH} spin magnitude and
the mass ratio. The signal recovery fraction is defined in section 
\ref{sec:bank_testing}.
It is clear that using a non-spinning bank to search for \ac{NSBH} systems will
result in a considerable reduction
in the \ac{NSBH} detection rate. In addition, the ability to
detect systems with high spin, especially systems that also have unequal 
masses, is especially poor.  We note that these efficiencies would be
improved by using non-spinning templates outside of the chosen mass ranges, for
example \ac{BNS} or binary black-hole template waveforms, or even templates
with unphysical mass parameters \cite{Brown:2012qf,Baird:2012cu}.

\subsection{Performance of aligned-spin template banks when searching for 
generic NSBH signals}
\label{sec:aligned_spin}

With the template banks of aligned-spin systems described in section
\ref{sec:bank_construction}, we are able to recover aligned-spin systems
modelled with either the TaylorT2 or TaylorT4 approximant with fitting factors
greater than 0.97 in $>99\%$ of cases, as shown in section
\ref{sec:bank_validation}.
If we use these banks to search for precessing systems modelled with the same
approximants, any loss in signal power, beyond that lost due to the spacing of
the aligned-spin bank, is entirely due to precession.
We now assess the performance of these aligned-spin banks when searching for
generic, precessing \ac{NSBH} signals and identify regions of the
parameter space where precessional effects cause a significant loss in
detection rate.

\begin{figure*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure11A.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure11B.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure11C.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure11D.pdf}
\caption{\label{fig:aspinavFF}
Average fitting factor between a set of generic, precessing, NSBH
signals and a template bank of aligned-spin waveforms as a function of the
component masses (top left) and as a function of the
mass ratio and the black hole dimensionless spin
magnitude (top right). Also plotted is the minimum fitting factor (bottom left) 
and the signal recovery fraction (bottom right) as a function of the
mass ratio and the black hole dimensionless spin magnitude. Both signals and
template waveforms are modelled using the TaylorT4 approximant.
The distribution that the NSBH signals are drawn from
is described in section \ref{sec:nsbhpop}. The template bank construction
is described in section \ref{sec:bank_construction}. Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{minipage}
\end{figure*}

\begin{figure}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure12.pdf}
\caption{\label{fig:arseofsauron}
The distribution of precessing NSBH signals that are recovered with fitting
factors $< 0.7$ when searching with an aligned-spin template bank. We use
$\hat{J}$ to denote the initial total angular momentum of the system, $\hat{n}$
denotes the line of sight towards the observer
and $\hat{L}$ denotes the orbital angular momentum when the gravitational wave frequency is 60 Hz 
(at which point approximately half of the signal power has accumulated). 
Both signals and template waveforms are modelled using the TaylorT4 approximant.
The distribution that the NSBH signals are drawn from
is described in section \ref{sec:nsbhpop}. The template bank construction
is described in section \ref{sec:bank_construction}. Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{figure}

\begin{figure}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure13.pdf}
\caption{\label{fig:nsspin}
Average fitting factor between a set of generic, precessing, NSBH
signals and a template bank of aligned-spin waveforms as a function of the
mass ratio and the neutron star dimensionless spin
magnitude (top right). Both signals and
template waveforms are modelled using the TaylorT4 approximant.
The distribution that the NSBH signals are drawn from
is described in section \ref{sec:nsbhpop}. The template bank construction
is described in section \ref{sec:bank_construction}. Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{figure}


\begin{figure*}
    \centering 
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure14A.pdf}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure14B.pdf}
\caption{\label{fig:aspinavFFT2}
Average fitting factor between a set of generic, precessing, NSBH
signals and a template bank of aligned-spin waveforms as a function of the
mass ratio and the black hole dimensionless spin magnitude. Shown when both the
template waveforms and signals are modelled with TaylorT2 (left) and when the
template waveforms are modelled with TaylorT2 and the signals are modelled with
TaylorT4 (right). The results in these plots are almost identical to each other 
and to the top right panel of Fig.~\ref{fig:aspinavFF}.
The distribution that the NSBH
signals are drawn from is described in section \ref{sec:nsbhpop}. The
template bank construction is described in section \ref{sec:bank_construction}.
Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{minipage}
\end{figure*}

\begin{figure}
\includegraphics[width=0.45\textwidth]
{papers/nsbh_effectualness/figure15.pdf}
\caption{\label{fig:aspinimpr}
The fractional increase in the number of recovered signals when
searching for generic, precessing, NSBH signals using
a template bank of aligned-spin waveforms and a template bank of non-spinning
waveforms. Both signals and template waveforms are modelled using the TaylorT4
approximant. The distribution that the NSBH
signals are drawn from is described in section \ref{sec:nsbhpop}. The
template bank construction is described in section \ref{sec:bank_construction}.
Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off.
}
\end{figure}

Our signal population is a set of 100,000 precessing \ac{NSBH} signals. This 
distribution was
described in section \ref{sec:nsbhpop}. For comparison this is the
\emph{same} set of signals as we used in section \ref{sec:non_spinning}.
As before, we will assess fitting factors using both the TaylorT2 and TaylorT4
models to mitigate any bias arising from choice of waveform model.
When TaylorT2 is used as the signal model, we will use the bank of aligned-spin
systems that was placed using the TaylorF2 metric and a 1000Hz
upper frequency cutoff and model the templates using the TaylorT2 approximant.
When TaylorT4 is used as the signal model, we will use the bank of aligned-spin
systems placed using the TaylorR2F4 metric and model the templates with
TaylorT4. The placement of these banks was described in section
\ref{sec:bank_construction}.

The results of these simulations can be seen in 
Fig.~\ref{fig:aspineffectualness}, where we also compare with the
results obtained in section \ref{sec:non_spinning} when using non-spinning
template banks. We can clearly see from Fig.~\ref{fig:aspineffectualness} that
the distribution of fitting factors for the
case when both signals and templates were modelled with TaylorT2 agrees well
with the case when both were modelled with TaylorT4. This indicates that
we have disentangled precessional effects from waveform-dependent effects and
our results are free of any bias due to the choice of waveform model.
The mismatches seen here, beyond that caused by the discreteness of the bank,
are due only to the effects of precession.
In both cases we observe a median fitting factor of
$\sim 0.95$ and a mean fitting factor of $\sim 0.91$. This is a clear
improvement
over the non-spinning results where the mean fitting factor was 0.82 (0.84) for
TaylorT2 (TaylorT4) and the median
fitting factor was 0.86 (0.88). 

In Fig.~\ref{fig:aspineffectualness} we also show results where the template
waveforms are modelled with TaylorT2 and the signals are modelled with TaylorT4.
In this case the performance is worse, with a median fitting factor of $\sim
0.92$ and a mean fitting factor of $\sim 0.88$.

In Fig.~\ref{fig:aspinavFF} we show the mean fitting factor as a function of
the intrinsic parameters
for our results with the TaylorT4 waveform. We also show the minimum fitting
factor and the signal recovery
fraction as a function of the \ac{BH} spin magnitude
and mass ratio for the same results.
The Figure serves to highlight that there are certain
systems in certain regions of the parameter space where precessional effects
cause the \ac{NSBH} signals to have large mismatches with a bank of
aligned-spin templates. This is most prominent when $m_{BH} / m_{NS}$ and the
\ac{BH} spin magnitude are both large, ie. where the black 
hole's angular momentum is particularly large relative to the orbital angular 
momentum. 
We explore this further in Fig.~\ref{fig:arseofsauron} where, following the
work of \cite{Brown:2012gs}, we show the distribution
of precessing systems recovered with fitting-factors smaller than $0.7$. This
is plotted as a function of the angles between the total angular 
momentum, the orbital angular momentum and the line of sight to an observer. 
As predicted in \cite{Brown:2012gs}, there is clearly a correlation
between these angles and the systems recovered with the lowest fitting factors.
To demonstrate that these results are not specific to the TaylorT4 waveform, in
Fig.~\ref{fig:aspinavFFT2} we show the mean fitting factor as a function of
the \ac{BH} spin magnitude and mass ratio for our TaylorT2 vs TaylorT2 and
TaylorT2 vs TaylorT4 results. The TaylorT2 results are very similar to the
TaylorT4 results in Fig.~\ref{fig:aspinavFF}. This again demonstrates that the
choice of waveform is not affecting our statements regarding the effect
precession will have on searches for \ac{NSBH} signals using aligned-spin
template banks. When searching for TaylorT4 signals with TaylorT2 templates
we see lower fitting factors. The disagreement between these two waveform models
is a significant factor that will affect searches for \ac{NSBH} systems with
second generation observatories. Computing higher order terms in the \acf{PN}
expansion of the center-of-mass energy and gravitational wave flux will help to
reduce this disagreement and produce waveforms that better match real
gravitational-wave signals. In Figure \ref{fig:nsspin} we plot the average 
fitting factor as a function of the mass ratio and the \emph{neutron star} 
dimensionless spin. There is not any noticeable correlation between the average 
fitting factor and the neutron star's spin.

We can also compare these results to the results we obtained using a
non-spinning template bank in section \ref{sec:non_spinning}. In 
Fig.~\ref{fig:aspinimpr} we show the fractional increase in the number
of recovered signals between using non-spinning and aligned-spin template banks
for the TaylorT4 approximant. The fractional increase in the number
of recovered signals is calculated by taking the ratio of the signal recovery 
fraction when using a non-spinning bank and the signal recovery fraction when 
using an aligned-spin bank. This figure helps to
emphasize that a much greater fraction of systems with large spin would be
recovered when using an aligned-spin template bank. In Table 
\ref{tab:results_summary} we summarize the average signal
recovery fractions for the aligned-spin banks and
compare these numbers to the results obtained with non-spinning template banks. 
We remind the reader that we are comparing signal recovery at a 
fixed signal-to-noise ratio. Signal recovery at a fixed false-alarm 
probability will depend on other factors, including the size of the parameter 
space covered by the template bank and the non-Gaussianity of the data. We 
discuss this further in the conclusion.

\begin{table*}
    \centering
    \begin{minipage}[l]{2.0\columnwidth}
    \centering
\begin{tabular}{p{1.6cm}|p{1.6cm}|p{1.85cm}|p{1.85cm}|p{1.85cm}|p{1.85cm}|p{
1.85cm}|p{1.85cm}}
\,\,\,\,\,\,Template  & \,\,\,\,\,\, Signal  & 
\multicolumn{2}{|p{3.7cm}|}{Signal recovery fraction
for non-spinning bank} & \multicolumn{2}{|p{3.7cm}|}
{Signal recovery fraction for aligned-spin bank} & 
\multicolumn{2}{|p{3.7cm}} {Fractional improvement
in signal recovery} \\ \cline{3-8}
 approximant & approximant & Average & $(10,1.4)M_{\odot}$ & Average
& $(10,1.4)M_{\odot}$ & Average & $(10,1.4)M_{\odot}$\\
\hline \hline
 TaylorT2 & TaylorT2 & 64\% & 63\% & 83\% & 74\% & 30\% & 17\% \\
 TaylorT4 & TaylorT4 & 69\% & 67\% & 82\% & 73\% & 19\% & 9\% \\
 TaylorT2 & TaylorT4 & 67\% & 64\% & 77\% & 67\% & 16\% & 5\% \\
\end{tabular}
\caption{\label{tab:results_summary}
The performance of our aligned-spin template banks when used to search for a
set of generic, precessing, NSBH signals using varying approximants for the
template and signal waveforms. We show both the mean signal recovery fraction 
over the full \ac{NSBH} signal population we consider and the signal recovery 
fraction for a \ac{NSBH} system with masses $(10\pm0.5,1.4\pm0.05)M_{\odot}$.
The distribution that
the NSBH signals are drawn from is described in section \ref{sec:nsbhpop}. The
template bank construction is described in section \ref{sec:bank_construction}.
Results obtained
using the zero-detuned, high-power advanced LIGO sensitivity curve with a 15Hz
lower frequency cut off and a 1000Hz upper frequency cut off.
}
\end{minipage}
\end{table*}

Finally, we compare our results with previous works. In \cite{Ajith:2012mn}
the authors presented an efficiency study when using a template bank of 
stochastically generated aligned-spin signals. We verified that when using the 
stochastic algorithm we used in this work, and using the same set of parameters 
as the study described in \cite{Ajith:2012mn}, we generated a bank with the 
same number of templates. We have therefore demonstrated that our template bank 
algorithm requires less templates to acheive the same level of coverage as the 
algorithm used in \cite{Ajith:2012mn}. In that work the effective fitting 
factor for a \ac{NSBH} system with masses given by $10 M_{\odot}$ ,
$1.4 M_{\odot}$ was estimated to be 0.95, which corresponds to a
signal recovery fraction of 86\%.
In contrast, our results show a lower signal recovery fraction 
for the same masses of $73 - 74\%$ when the same waveform model is used to 
model both the template and signal. It isn't clear why this discrepancy 
occurs, however it may be partially explained by the fact that 
the authors of \cite{Ajith:2012mn} used a lower frequency cutoff in their 
matched-filters of 20Hz, whereas we used 15Hz, which is more appropriate for the 
predicted \ac{aLIGO} zero-detuned--high-power noise curve. 

In \cite{Brown:2012gs} the authors used a simplified model of precessing systems
to predict the distribution of fitting
factors for \ac{NSBH} systems. These results, shown in Figure 11 of that work,
agree qualitatively with the results obtained here.
We also obtain quantitative agreement by comparing our simulations of 
generic precessing systems with TaylorT4 as the signal and template model with 
the values predicted by Eq. 46b of \cite{Brown:2012gs}. We find that 90\% of 
the fitting factors are within $0.03$ of the predicted values.
They also predicted the 
distribution of the signals that would be recovered with the lowest fitting 
factors as a function of the orientation of the black hole spin and the 
orientation of the orbital plane with respect to the line of sight. We produce 
a similar distribution in Fig.~\ref{fig:arseofsauron}. 
A further exploration of the agreement of the fitting factors with 
this prediction will be carried out in a future work making use of these 
simulations.

\section{Conclusions}
\label{sec:conclusion}

In this work we have explored the effect that the angular momentum of the black
hole will have on searches for neutron-star black-hole binaries with
\ac{aLIGO}. The black hole's angular momentum will affect the phase evolution
of the emitted gravitational-wave signal, and, if the angular momentum is
misaligned with the orbital plane, will cause the system to precess. We have
found that if these effects are neglected in the filter waveforms used to
search for \ac{NSBH} binaries it will result in a loss in detection rate of
$31-36\%$ when searching for \ac{NSBH} systems with masses uniformly 
distributed in the range 
$(3-15,1-3)M_{\odot}$. When restricting the masses to 
$(9.5-10.5,1.35-1.45)M_{\odot}$ we find that the loss in detection rate is
$33 - 37\%$. The error in these measurements is due to uncertainty in 
the \ac{PN} waveform models used to simulate \ac{NSBH} gravitational-wave 
signals.  In a companion work we investigate how the uncertainty in waveform 
models used to simulate \ac{NSBH} waveforms will reduce detection 
efficiency~\cite{Nitz:2013mxa}. 

We have presented a new method to create a template bank of \ac{NSBH} filter
waveforms, where the black hole's angular momentum is
included, but is restricted to be (anti-)aligned with the orbit. These
waveforms will include the effect that the black hole's angular momentum has on
the phase evolution of the gravitational-wave signal, but will not include any
precessional effects. We have shown that this bank offers a
$16\%-30\%$ improvement in the detection rate of neutron-star black-hole
mergers when compared to a non-spinning template bank when searching for 
\ac{NSBH} systems with masses in the range $(3-15,1-3)M_{\odot}$. However, when
searching for \ac{NSBH} systems with masses restricted to the range 
$(9.5-10.5,1.35-1.45)M_{\odot}$ we find the improvement is reduced to $5-17\%$.
Some systems are not recovered well with this new bank of filters. These systems
are ones where the black-hole spin is misaligned with the orbit and the waveform
is significantly modified due to precession of the orbital plane. This happens
most often when $m_{BH} / m_{NS}$ and the spin magnitude are both large. In
\cite{Brown:2012gs} the authors predict where in the parameter space to expect
\ac{NSBH} systems that will not be recovered well by non-precessing template
banks. These predictions were
given in terms of the angles between the orbital plane, the black hole's angular
momentum and the line-of-sight to an observer. These predictions agree with the
results that we obtain in this work. In \cite{Ajith:2012mn} the authors claim
that an aligned-spin template bank will be effectual for detecting precessing
\ac{NSBH} systems. In this work, we find that with an aligned-spin template
bank $17-23\%$ of \ac{NSBH} systems will be missed compared to an ideal search
with
exactly matching filter waveforms. In reality this ideal search could never
be performed as it would require an infinite number of filter waveforms.
Template banks are usually constructed to allow for no more than a 3\% loss in
\ac{SNR}, therefore we expect to lose up to $10\%$ of systems even if the
template bank fully covers the signal parameter space. We therefore conclude
that searches using precessing waveforms as templates could potentially
increase the detection rate of \ac{NSBH} signals, but not by more than $\sim
20\%$. Performing such a search would, however, remove an observational bias
against systems where precessional effects are most prevalent in the
gravitational-wave signal.

These figures are also affected by the 
parameter distribution chosen for the \ac{NSBH} systems. Here we chose a 
distribution that is uniform in mass, uniform in spin magnitudes, isotropic in 
spin orientations and isotropic in orientation parameters and sky location. We 
have however, explored how the ability to detect precessig \ac{NSBH} signals 
varies as a function of the masses and spins as seen in Figures 
\ref{fig:aspinavFF} and \ref{fig:arseofsauron}. 

When searching for \ac{NSBH} systems in \ac{aLIGO} one has to
consider the non-Gaussianity of the background noise, which we have not done in
this work. A non-Gaussian noise
artifact can produce \acp{SNR} that are considerably larger than those expected
from Gaussian noise fluctutations. To deal with this, numerous
consistency tests are used in the analyses to separate gravitational wave
signals from instrumental noise artifacts \cite{Babak:2012zx}. It is possible
that the detection rate could be further reduced from the values we quote in
this work if some signals \emph{fail} these consistency tests and are
mis-classified as non-Gaussian noise transients.
However, these signal consistency tests should only act to remove, or reduce the
significance of, events that already have low fitting factors and therefore do
not match well with the search templates. 
Another important consideration is that of the
number of templates used in the bank. To achieve higher fitting factors will
require more template waveforms, covering a larger signal space, which will 
allow more freedom in matching the
background noise and will mean that the \ac{SNR} of the loudest background
triggers will increase. Therefore signals will need slightly higher \acp{SNR} to
achieve the same false alarm probability. However, a factor of 10 increase in
the number of \emph{independent} templates will only increase the expected
\ac{SNR} of the loudest background event by less than $5\%$, if 
Gaussian noise is assumed. Therefore, while we
are careful to note these considerations, we do not believe they will have a
large impact on the numbers we quote above and leave a detailed investigation of
such effects to future work.

In this work we have restricted ourselves to 
considering post-Newtonian, inspiral-only signal waveforms and consider only the 
case of two point particles. This was done as there is not currently any widely 
available waveform model that includes both the full evolution of a \ac{NSBH} 
coalescence \emph{and} includes precessional effects over the full parameter 
space that we consider. When such a model is available it may be that 
tidal forces and the merger component of the waveform may affect our 
conclusions. We believe that such effects will be limited as the
black hole mass is $< 15 M_{\odot}$ in our simulations, however it would be 
informative to repeat our simulations when a full \ac{NSBH} waveform model is 
available.

